(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2be21cda"],{2236:function(e,t,o){},"3b61":function(e,t,o){"use strict";o.r(t);var r={};o.r(r),o.d(r,"request",(function(){return s})),o.d(r,"pageRequest",(function(){return u})),o.d(r,"remove",(function(){return d})),o.d(r,"edit",(function(){return c})),o.d(r,"add_good",(function(){return f})),o.d(r,"importFile",(function(){return m})),o.d(r,"notAllowed",(function(){return p}));var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[o("div",{staticClass:"operation"},[o("el-button",{directives:[{name:"has",rawName:"v-has",value:[e.goods.request],expression:"[goods.request]"}],attrs:{size:"small",type:"primary"},on:{click:e.fetchData}},[e._v("查询")]),o("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addNewGood}},[e._v("新增")]),e._m(0),o("el-upload",{staticClass:"upload-goods",attrs:{size:"small",action:"","http-request":e.importFromFile,"on-change":e.handleChange,"file-list":e.fileList,"before-upload":e.validateFile}},[o("el-button",{attrs:{size:"small",type:"primary"}},[e._v("导入xls")]),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传xls/xlsx文件 ")])],1)],1),o("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list,border:""}},[o("el-table-column",{attrs:{prop:"fruitId",label:"商品编号",width:"120"}}),o("el-table-column",{attrs:{prop:"fruitName",label:"商品名称"}}),o("el-table-column",{attrs:{prop:"fruitLevel",label:"等级",width:"60"}}),o("el-table-column",{attrs:{prop:"fruitFrom",label:"产地"}}),o("el-table-column",{attrs:{prop:"fruitUnit",label:"计价单位"}}),o("el-table-column",{attrs:{prop:"fruitPrice",label:"价格"}}),o("el-table-column",{attrs:{prop:"fruitVipPrice",label:"会员价格"}}),o("el-table-column",{attrs:{prop:"fruitPrePrice",label:"促销信息"}}),o("el-table-column",{attrs:{prop:"createTime",label:"创建时间",align:"center",width:"120",formatter:e.formateDate}}),o("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(o){return e.editGood(t.row.id)}}},[e._v("编辑")]),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){return e.askDelete(t.row.id)}}},[e._v("删除")])]}}])})],1),o("br"),o("el-dialog",{attrs:{title:"新增商品信息",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("add-goods",{on:{insertGoods:e.insertNewGoods}})],1),o("el-dialog",{attrs:{title:"编辑商品信息",visible:e.editFormVisible},on:{"update:visible":function(t){e.editFormVisible=t}}},[o("add-goods",{attrs:{goodInfo:e.selectedGoodInfo,dataInit:e.dataInit},on:{modifyGoods:e.modifyGoods}})],1)],1)},n=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("br")])}],l=o("365c"),a="adminFruit",s={p:["post,/goods"],r:function(e){return l["a"].post("".concat(a,"/list"),e)}},u={p:["post,/goods"],r:function(e){return l["a"].post("".concat(a,"/page"),e)}},d={p:["post,/goods/**"],r:function(e){return l["a"].post("".concat(a,"/delete"),e)}},c={p:["post,/goods/**"],r:function(e){return l["a"].post("".concat(a,"/update"),e)}},f={p:["post,/goods/**"],r:function(e){return l["a"].post("".concat(a,"/add"),e)}},m={p:["post,/goods/**"],r:function(e){return l["a"].post("".concat(a,"/importExcel"),e,{headers:{post:{"Content-Type":"multipart/form-data"}}})}},p={p:["get,/roles/notAllowed"],r:function(e){return l["a"].get("".concat(a,"/roles/notAllowed"),{params:e})}},g=o("3da7"),h=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"100px",size:"small"}},[o("el-form-item",{attrs:{label:"编号",prop:"fruitId"}},[o("el-input",{model:{value:e.ruleForm.fruitId,callback:function(t){e.$set(e.ruleForm,"fruitId",t)},expression:"ruleForm.fruitId"}})],1),o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),o("el-form-item",{attrs:{label:"产地",prop:"from"}},[o("el-input",{model:{value:e.ruleForm.from,callback:function(t){e.$set(e.ruleForm,"from",t)},expression:"ruleForm.from"}})],1),o("el-form-item",{attrs:{label:"等级",prop:"level"}},[o("el-input",{model:{value:e.ruleForm.level,callback:function(t){e.$set(e.ruleForm,"level",t)},expression:"ruleForm.level"}})],1),o("el-form-item",{attrs:{label:"计价单位",prop:"unit"}},[o("el-input",{model:{value:e.ruleForm.unit,callback:function(t){e.$set(e.ruleForm,"unit",t)},expression:"ruleForm.unit"}})],1),o("el-form-item",{attrs:{label:"价格",prop:"price"}},[o("el-input",{model:{value:e.ruleForm.price,callback:function(t){e.$set(e.ruleForm,"price",t)},expression:"ruleForm.price"}})],1),o("el-form-item",{attrs:{label:"会员价格",prop:"vip-price"}},[o("el-input",{model:{value:e.ruleForm.vip_price,callback:function(t){e.$set(e.ruleForm,"vip_price",t)},expression:"ruleForm.vip_price"}})],1),o("el-form-item",{attrs:{label:"促销信息",prop:"promot"}},[o("el-input",{model:{value:e.ruleForm.promotion,callback:function(t){e.$set(e.ruleForm,"promotion",t)},expression:"ruleForm.promotion"}})],1),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("提交")]),o("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)},v=[],b=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[o("div",{staticClass:"operation"},[o("el-button",{directives:[{name:"has",rawName:"v-has",value:[e.role.request],expression:"[role.request]"}],attrs:{size:"small",type:"primary"},on:{click:e.fetchData}},[e._v("查询")]),o("el-button",{directives:[{name:"has",rawName:"v-has",value:[e.role.remove],expression:"[role.remove]"}],attrs:{size:"small",type:"danger"}},[e._v("删除")]),o("el-button",{attrs:{size:"small",type:"info"},on:{click:e.requestNotAllowed}},[e._v("尝试发起越权请求")])],1),o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list,border:""}},[o("el-table-column",{attrs:{prop:"name",label:"名称",width:"120"}}),o("el-table-column",{attrs:{prop:"timestamp",label:"创建时间",formatter:e.formateDate}}),o("el-table-column",{attrs:{prop:"summary",label:"备注","show-overflow-tooltip":!0}}),o("el-table-column",{attrs:{label:"操作",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",type:"info"}},[e._v("编辑")]),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){return e.deleteRole(t.row.id)}}},[e._v("删除")])]}}])})],1)],1)},F=[],I=o("cc5e"),w={data:function(){return{role:I}}},x={mixins:[w],data:function(){return{list:[],canReset:!0,loading:!1}},methods:{fetchData:function(){var e=this;this.loading=!0,I["request"].r().then((function(t){e.list=t.data.content,e.loading=!1}))},deleteRole:function(e){var t=this;this.loading=!0,I["remove"].r({id:e}).then((function(e){t.loading=!1,alert(e.data)})).catch((function(e){t.loading=!1}))},requestNotAllowed:function(){I["notAllowed"].r()},formateDate:function(e,t,o,r){return g["d"](o,"MM/dd hh:mm")}},created:function(){this.fetchData()}},_=x,y=(o("f38c"),o("2877")),$=Object(y["a"])(_,b,F,!1,null,"ca20a54e",null),P=($.exports,{data:function(){var e=function(e,t,o){""===t&&o(new Error("商品名不能为空")),o()},t=function(e,t,o){""===t&&o(new Error("此项不能为空")),o()};return{ruleForm:{name:this.goodInfo?this.goodInfo.fruitName:"",from:this.goodInfo?this.goodInfo.fruitFrom:"",level:this.goodInfo?this.goodInfo.fruitLevel:"",unit:this.goodInfo?this.goodInfo.fruitUnit:"",price:this.goodInfo?this.goodInfo.fruitPrice:"",vip_price:this.goodInfo?this.goodInfo.fruitVipPrice:"",promotion:this.goodInfo?this.goodInfo.fruitPrePrice:"",fruitId:this.goodInfo?this.goodInfo.fruitId:""},rules:{name:[{validator:e,trigger:"blur"}],fruitId:[{validator:t,trigger:"blur"}],from:[{validator:t,trigger:"blur"}],level:[{validator:t,trigger:"blur"}]}}},props:["goodInfo","dataInit"],computed:{isDisabled:function(){return this.ruleForm={name:this.goodInfo?this.goodInfo.fruitName:"",from:this.goodInfo?this.goodInfo.fruitFrom:"",level:this.goodInfo?this.goodInfo.fruitLevel:"",unit:this.goodInfo?this.goodInfo.fruitUnit:"",price:this.goodInfo?this.goodInfo.fruitPrice:"",vip_price:this.goodInfo?this.goodInfo.fruitVipPrice:"",promotion:this.goodInfo?this.goodInfo.fruitPrePrice:"",fruitId:this.goodInfo?this.goodInfo.fruitId:""},this.goodInfo?1:0}},methods:{submitForm:function(e){var t=this,o=this;this.$refs[e].validate((function(r){if(!r)return console.log("error submit!!"),!1;o.$loading=!0,t.goodInfo?c.r({fruitName:t.ruleForm.name,fruitFrom:t.ruleForm.from,fruitLevel:t.ruleForm.level,fruitPrice:t.ruleForm.price,fruitVipPrice:t.ruleForm.vip_price,fruitPrePrice:t.ruleForm.promotion,fruitUnit:t.ruleForm.unit,fruitId:t.ruleForm.fruitId,id:t.goodInfo.id}).then((function(e){t.$message.success("信息修改成功"),o.$loading=!1,o.goodInfo.fruitName=o.ruleForm.name,o.goodInfo.fruitFrom=o.ruleForm.from,o.goodInfo.fruitLevel=o.ruleForm.level,o.goodInfo.fruitPrice=o.ruleForm.price,o.goodInfo.fruitVipPrice=o.ruleForm.vip_price,o.goodInfo.fruitPrePrice=o.ruleForm.promotion,o.goodInfo.fruitUnit=o.ruleForm.unit,o.goodInfo.fruitId=o.ruleForm.fruitId,t.$emit("modifyGoods",o.goodInfo)}),g["b"]):f.r({fruitName:t.ruleForm.name,fruitFrom:t.ruleForm.from,fruitLevel:t.ruleForm.level,fruitPrice:t.ruleForm.price,fruitVipPrice:t.ruleForm.vip_price,fruitPrePrice:t.ruleForm.promotion,fruitUnit:t.ruleForm.unit,fruitId:t.ruleForm.fruitId}).then((function(o){t.$message.success("添加成功"),t.$loading=!1,t.$refs[e].resetFields(),t.$emit("insertGoods",o.data.result)}),g["b"])}))},resetForm:function(e){this.$refs[e].resetFields()}}}),z=P,k=Object(y["a"])(z,h,v,!1,null,"0dd9062c",null),N=k.exports,G={data:function(){return{goods:r}}},D={components:{addGoods:N},mixins:[G],data:function(){return{list:[],currentPage:1,pageSize:10,totalSize:0,loading:!1,canReset:!1,dialogFormVisible:!1,editFormVisible:!1,selectedGoodInfo:null,dataInit:!1,fileList:[]}},methods:{handleSizeChange:function(e){this.pageSize=e,this.fetchData()},handleCurrentChange:function(e){this.currentPage=e,this.fetchData()},fetchData:function(){var e=this;e.loading=!0,u.r({pageNum:e.currentPage,pageSize:e.pageSize}).then((function(t){e.totalSize=parseInt(t.data.result.total),e.list=t.data.result.data,e.loading=!1}))},importFromFile:function(e){var t=this,o=new FormData;o.append("file",e.file),m.r(o).then((function(e){t.fileList=[],t.$message.success("上传成功"),t.fetchData()}),g["b"])},validateFile:function(e){return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==e.type||"application/vnd.ms-excel"==e.type||(this.$message.warning("请上传xls/xlsx类型的文件"),!1)},handleChange:function(e,t){this.fileList=t},insertNewGoods:function(e){var t=this;t.list.splice(0,0,e),t.dialogFormVisible=!1},modifyGoods:function(e){var t=this.list.findIndex((function(t){return t.id==e.id}));this.list.splice(t,1,e),this.editFormVisible=!1},requestNotAllowed:function(){p.r()},formateDate:function(e,t,o,r){return g["d"](o,"MM/dd hh:mm")},addNewGood:function(){this.dialogFormVisible=!0},editGood:function(e){var t=this.list.find((function(t){return t.id==e}));this.dataInit=!1,this.selectedGoodInfo=t,this.editFormVisible=!0;var o=this;this.$nextTick((function(){o.dataInit=!0}))},askDelete:function(e){var t=this;t.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then((function(){t.deleteGood(e)})).catch((function(){}))},deleteGood:function(e){var t=this;t.$loading=!0,d.r({id:e}).then((function(o){t.$loading=!1;var r=t.list.findIndex((function(t){return t.id==e}));t.list.splice(r,1),t.$message.success("删除成功")}),g["b"])}},created:function(){this.fetchData()}},V=D,C=Object(y["a"])(V,i,n,!1,null,"0b084b26",null);t["default"]=C.exports},f38c:function(e,t,o){"use strict";o("2236")}}]);
//# sourceMappingURL=chunk-2be21cda.da2e7b55.js.map